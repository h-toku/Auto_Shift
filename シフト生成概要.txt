✅ 基本仕様
対象規模
スタッフ数：10〜15名

営業時間：1日7〜8時間程度

祝日は4種類に分類済み（曜日別処理と同様に対応）

✅ スタッフ種別
区分	備考
社員	希望に関係なく、statusが空白でなければ全日フルタイム勤務（open〜close）
バイト	シフト希望に基づき、自動で採用/不採用を判断
未成年バイト	就労制限（時間帯・連勤数など）への対応は後ほど検討

✅ シフト希望 (ShiftRequest)
status は "O" / "X" / "time" / 空白のいずれか

"O"：所属店舗の開店〜閉店（open〜close）まで勤務可能

"X" / 空白：勤務不可

"time"：start_time〜end_time の時間のみ勤務可能（この時間帯は連続している）

希望時間帯が「シフトパターン」に含まれる場合のみ採用対象とする

例：希望が5〜9時で、パターンが6〜10時 → ✕（不採用）

✅ シフトパターン (ShiftPattern)
営業時間に対して定義された複数の勤務パターン（例：5–10、6–11、7–12）

スタッフは、自身の希望時間帯に含まれるパターンにのみマッチ可能

フルタイム（"O"）のスタッフは、どのパターンにもマッチ可能

✅ シフト採用ロジック
1. 不採用ロジック（バイトのみ適用）
社員は常に勤務可能として扱い、不採用ロジックから除外。

不採用回数を記録し、希望日数に対して均等な割合で分配することで公平性を確保。

例：10日希望 → 約3日不採用、30日希望 → 約9日不採用（ただし月によって変動）。

過去の不採用回数とのバランスも見て調整可能（オプション要素）。

2. 連勤制限ロジック
人数が足りない4連続日がない限り、4連勤は原則避ける。

3連勤などの中日（例：19〜21日）が人数不足で採用された場合：

前後（例：18日・22日）は優先的に不採用にする。

ただし、どうしても回避できない場合は「希望日数が多いスタッフを優先して連勤許可」する。

3. スキル評価について
スキル点数は、最大値を単純に追求しない。

各時間帯の必要スキルに対し、「基準点に近い構成」を優先。

「ランク（社員・バイト・未成年）」の影響はそのまま維持。

4. ピーク時間重視・両端対応ロジック
■ 基本原則
ピーク人数（peak_people）を最優先で確保する。

人数不足ならピークに対応する全員をまず採用。

その後、オープン・クローズ時間帯の人員を調整。

■ スコア設計（採用優先度）

score = peak_cover_ratio + max(can_open, can_close)

peak_cover_ratio: 希望時間がピーク時間と重なる割合（0〜1）

can_open: 希望時間が店舗のopen_timeと一致 or 早い → 1

can_close: 希望時間がclose_timeと一致 or 遅い → 1

例：
希望シフト	ピーク率	オープン対応	クローズ対応	スコア
10〜14	1.0	0	0	1.0
9〜13	0.75	1	0	1.75
13〜17	0.5	0	1	1.5

5. 希望シフトのルール
連続時間のみ許可（例：5〜8と9〜12のような分断された希望は不可）。

"O"ステータスのスタッフは、全パターンに対応可。

"time" ステータスは、希望時間が いずれかのシフトパターンを含んでいれば採用可能。

希望時間が偏っていて、パターンに合わない場合でも、柔軟に希望通り採用することもあり得る（人数が足りていれば）。