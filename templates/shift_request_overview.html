{% extends "base.html" %}

{% block header_title %}シフト希望確認{% endblock %}

{% block content %}
<body>
    <h1>シフト希望確認</h1>

    <div class="select-year-month">
    <form method="get" action="/shift_request/overview">
        <select name="year">
            {% for y in years %}
            <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
            {% endfor %}
        </select>年
        <select name="month">
            {% for m in months %}
            <option value="{{ m }}" {% if m == selected_month %}selected{% endif %}>{{ m }}</option>
            {% endfor %}
        </select>月
        <button type="submit">表示</button>
        </form>


        
        <form method="post" action="/shift/generate" style="display: inline">
          <button type="submit">シフト作成</button>
        </form>
    </div>

<div class="scrollable-table-wrapper">
      <table class="calendar-table">
        <thead>
          <tr>
            <th class="sticky-col sticky-header">日付</th>
            {% for staff in staffs %}
            <th class="sticky-header" style="color: {{ staff.color }};">{{ staff.name }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for day in days_in_month %}
          <tr>
            <td class="sticky-col {{ day.style_class }}">
              {{ day.day }}<br><span style="font-size: 0.7em;">{{ day.weekday }}</span>
            </td>
            {% for staff in staffs %}
            <td class="{{ day.style_class }}">
              {% set shift = staff_shifts.get(staff.id, {}).get(day.day) %}
              {% if shift %}
              {% if shift.status in ["○", "×"] %}
              <span style="font-size: 25px;">{{ shift.status }}</span>
            {% else %}
              <span>{{ shift.status }}</span>
            {% endif %}
            </td>
            {% endif %}
            {% endfor %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

{% endblock %}