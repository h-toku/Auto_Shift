{% extends "base.html" %}

{% block header_title %}ホーム{% endblock %}

{% block content %}
  {% if user_logged_in %}
  <div class="calendar-container">
    <h2>カレンダー（月表示）</h2>
    <div class="select-year-month">
      <form method="get">
        <select name="year">
          {% for y in years %}
            <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
          {% endfor %}
        </select> 年
  
        <select name="month">
          {% for m in months %}
            <option value="{{ m }}" {% if m == selected_month %}selected{% endif %}>{{ m }}</option>
          {% endfor %}
        </select> 月
  
        <button type="submit">表示</button>
      </form>
    </div>
  
    <table class="calendar-table fixed-column">
      <thead>
        <tr><th>日</th></tr>
      </thead>
      <tbody>
        {% for day in days_in_month %}
        <tr>
          <td class="{{ day.style_class }}">
            {{ day.day }}<br><span style="font-size: 0.7em;">{{ day.weekday }}</span>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    
      <!-- 横スクロールテーブル -->
      <div class="scrollable-table-container">
        <table class="calendar-table">
          <thead>
            <tr>
              {% for staff in staffs %}
              <th style="color: {{ staff.color }};">{{ staff.name }}</th>
              {% endfor %}
            </tr>
          </thead>
          <tbody>
            {% for day in days_in_month %}
            <tr>
              {% for staff in staffs %}
              <td class="{{ day.style_class }}">
                {% if staff_shifts[staff.id][day.day] %}
                  <span>{{ staff_shifts[staff.id][day.day].start }} - {{ staff_shifts[staff.id][day.day].end }}</span>
                {% else %}
                  <span class="off">-</span>
                {% endif %}
              </td>
              {% endfor %}
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    
    {% else %}
      <div class="login-message">
        <p>店長にIDとパスワードを聞いてログインしてください。</p>
        <a href="{{ login_button.url }}" class="login-button">
          {{ login_button.name }}
        </a>
      </div>
    {% endif %}
    {% endblock %}
