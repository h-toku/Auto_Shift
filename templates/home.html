{% extends "base.html" %}

{% block title %}ホーム{% endblock %}

{% block header_title %}ホーム画面{% endblock %}

{% block content %}
  {% if user_logged_in %}
  <div class="calendar-container">
    <h2>カレンダー（月表示）</h2>
    <div class="select-year-month">
      <form method="get">
        <select name="year">
          {% for y in years %}
            <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
          {% endfor %}
        </select> 年
  
        <select name="month">
          {% for m in months %}
            <option value="{{ m }}" {% if m == selected_month %}selected{% endif %}>{{ m }}</option>
          {% endfor %}
        </select> 月
  
        <button type="submit">表示</button>
      </form>
    </div>
  
    <table class="calendar-table">
      <thead>
        <tr>
          <th>スタッフ名</th>
          {% for day in days_in_month %}
            <th class="{{ day.style_class }}">
              {{ day.day }}
            </th>
          {% endfor %}
        </tr>
        <tr>
          <th></th>
          {% for day in days_in_month %}
            <th class="{{ day.style_class }}">
              {{ day.weekday }}
            </th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for staff in staffs %}
          <tr>
            <td style="color: {{ staff.color }};">{{ staff.name }}</td>
            {% for day in days_in_month %}
              <td class="{{ day.style_class }}">
                {% if staff_shifts[staff.id][day.day] %}
                  <span>{{ staff_shifts[staff.id][day.day].start }} - {{ staff_shifts[staff.id][day.day].end }}</span>
                {% else %}
                  <span class="off"></span>
                {% endif %}
              </td>
            {% endfor %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  
  {% else %}
    <div class="login-message">
      <p>店長にIDとパスワードを聞いてログインしてください。</p>
      <a href="{{ login_button.url }}" class="login-button">
        {{ login_button.name }}
      </a>
    </div>
  {% endif %}
{% endblock %}
